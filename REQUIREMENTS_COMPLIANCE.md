# Соответствие требованиям технического задания

## Общие требования

### ✅ Backend на Java EE с использованием EJB

**Требование**: Уровень back-end должен быть основан на Java EE (необходимо использовать EJB).

**Реализация**:
- Используется **Jakarta EE** (современная версия Java EE)
- Реализованы **Stateless EJB**:
  - `UserEJB` - для работы с пользователями
  - `ResultEJB` - для работы с результатами
- Реализован **Singleton EJB**:
  - `PersistenceInitializer` - для инициализации БД при старте
- Используется **Dependency Injection** через `@EJB`
- Используется **JPA** для работы с БД

**Файлы**:
- `Web4/src/main/java/org/example/ejb/UserEJB.java`
- `Web4/src/main/java/org/example/ejb/ResultEJB.java`
- `Web4/src/main/java/org/example/ejb/PersistenceInitializer.java`

### ✅ Frontend на React + Redux с ES6 и JSX

**Требование**: Уровень front-end должен быть построен на React + Redux (необходимо использовать ES6 и JSX) с использованием набора компонентов Belle.

**Реализация**:
- Используется **React 18** с функциональными компонентами и хуками
- Используется **Redux** для управления состоянием:
  - `authReducer` - состояние аутентификации
  - `resultReducer` - состояние результатов
  - `rootReducer` - объединение reducers
- Используется **Redux Thunk** для асинхронных actions
- Используется **ES6+ синтаксис**:
  - Arrow functions
  - Destructuring
  - Template literals
  - Async/await
  - Spread operator
- Используется **JSX** для описания UI
- Используются **компоненты Belle** (кастомная реализация):
  - `TextInput` - текстовое поле
  - `Button` - кнопка
  - `Checkbox` - чекбокс

**Файлы**:
- `Web4Frontend/src/components/BelleComponents.js`
- `Web4Frontend/src/components/LoginPage.js`
- `Web4Frontend/src/components/MainPage.js`
- `Web4Frontend/src/store/`

### ✅ REST API для взаимодействия

**Требование**: Взаимодействие между уровнями back-end и front-end должно быть организовано посредством REST API.

**Реализация**:
- Используется **JAX-RS** (Jakarta RESTful Web Services)
- Реализованы REST endpoints:
  - `POST /api/auth/login` - вход
  - `POST /api/auth/register` - регистрация
  - `POST /api/results/check?userId={id}` - проверка точки
  - `GET /api/results?userId={id}` - получение результатов
  - `DELETE /api/results?userId={id}` - удаление результатов
- Используется **JSON** для обмена данными
- Реализован **CORS фильтр** для cross-origin запросов

**Файлы**:
- `Web4/src/main/java/org/example/rest/ApplicationConfig.java`
- `Web4/src/main/java/org/example/rest/AuthResource.java`
- `Web4/src/main/java/org/example/rest/ResultResource.java`
- `Web4/src/main/java/org/example/rest/CorsFilter.java`

### ✅ Две страницы приложения

**Требование**: Приложение должно включать в себя 2 страницы - стартовую и основную страницу приложения.

**Реализация**:
- **Стартовая страница**: `LoginPage.js`
- **Основная страница**: `MainPage.js`
- Маршрутизация через `App.js` на основе `isAuthenticated`

**Файлы**:
- `Web4Frontend/src/components/LoginPage.js`
- `Web4Frontend/src/components/MainPage.js`
- `Web4Frontend/src/App.js`

### ✅ Адаптивный дизайн (3 режима)

**Требование**: Обе страницы должны быть адаптированы для отображения в 3 режимах:
- "Десктопный" - для устройств, ширина экрана которых равна или превышает 1189 пикселей
- "Планшетный" - для устройств, ширина экрана которых равна или превышает 766, но меньше 1189 пикселей
- "Мобильный" - для устройств, ширина экрана которых меньше 766 пикселей

**Реализация**:
- Используются **CSS Media Queries**:
  - `@media (min-width: 1189px)` - десктопный режим
  - `@media (min-width: 766px) and (max-width: 1188px)` - планшетный режим
  - `@media (max-width: 765px)` - мобильный режим
- Адаптивные изменения:
  - Размеры canvas
  - Расположение элементов (grid/flex)
  - Размеры шрифтов
  - Отступы и padding

**Файлы**:
- `Web4Frontend/src/styles.css` (строки 177-310)

## Стартовая страница

### ✅ Шапка с ФИО, группой и вариантом

**Требование**: "Шапку", содержащую ФИО студента, номер группы и номер варианта.

**Реализация**:
- Заголовок: "Павлов Эдгар P3216 88744"
- Отображается в компоненте `LoginPage`

**Файлы**:
- `Web4Frontend/src/components/LoginPage.js` (строка 27)

### ✅ Форма для ввода логина и пароля

**Требование**: Форму для ввода логина и пароля.

**Реализация**:
- Используются компоненты `TextInput` из BelleComponents
- Поля: `username` и `password` (type="password")
- Кнопки: "Войти" и "Зарегистрироваться"
- Переключение между режимами входа и регистрации

**Файлы**:
- `Web4Frontend/src/components/LoginPage.js` (строки 30-75)

### ✅ Хранение пользователей в БД с хэшированием паролей

**Требование**: Информация о зарегистрированных в системе пользователях должна храниться в отдельной таблице БД (пароль должен храниться в виде хэш-суммы).

**Реализация**:
- Таблица `users` в БД:
  - `ID` (BIGINT, автоинкремент)
  - `username` (VARCHAR(50), UNIQUE)
  - `passwordHash` (VARCHAR(255))
- Используется **BCrypt** для хэширования паролей
- Метод `UserEJB.createUser()` хэширует пароль перед сохранением
- Метод `UserEJB.validatePassword()` проверяет пароль через BCrypt

**Файлы**:
- `Web4/src/main/java/org/example/entity/User.java`
- `Web4/src/main/java/org/example/ejb/UserEJB.java` (строки 42-64, 66-72)
- `Web4/src/main/java/org/example/ejb/PersistenceInitializer.java` (строки 26-33)

### ✅ Запрет доступа неавторизованных пользователей

**Требование**: Доступ неавторизованных пользователей к основной странице приложения должен быть запрещён.

**Реализация**:
- Проверка `isAuthenticated` в `App.js`
- Если не авторизован - показывается `LoginPage`
- Если авторизован - показывается `MainPage`
- Проверка сессии при загрузке через `checkAuth()`

**Файлы**:
- `Web4Frontend/src/App.js` (строки 9, 17)
- `Web4Frontend/src/store/actions/authActions.js` (строки 85-96)

## Основная страница

### ✅ Checkbox для X

**Требование**: Checkbox {'-3','-2','-1','0','1','2','3','4','5'} для координаты по оси X.

**Реализация**:
- Массив `xValues = ['-3', '-2', '-1', '0', '1', '2', '3', '4', '5']`
- Отображение через `Checkbox` компоненты
- Можно выбрать только одно значение
- Также можно выбрать X через клик на графике

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 22, 264-277)

### ✅ TextInput для Y

**Требование**: TextInput (-5 ... 5) для координаты по оси Y.

**Реализация**:
- Компонент `TextInput` для ввода Y
- Валидация формата (число, точка/запятая)
- Валидация диапазона (-5 до 5)
- Мгновенная валидация при вводе
- Отображение ошибок под полем

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 282-291, 62-115)

### ✅ Checkbox для R

**Требование**: Checkbox {'-3','-2','-1','0','1','2','3','4','5'} для задания радиуса области.

**Реализация**:
- Массив `rValues = ['-3', '-2', '-1', '0', '1', '2', '3', '4', '5']`
- Отображение через `Checkbox` компоненты
- Можно выбрать только одно значение
- Валидация: R должен быть положительным

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 23, 293-312)

### ✅ Валидация некорректных данных

**Требование**: Если поле ввода допускает ввод заведомо некорректных данных (таких, например, как буквы в координатах точки или отрицательный радиус), то приложение должно осуществлять их валидацию.

**Реализация**:
- **Валидация Y**:
  - Проверка формата (только цифры, точка/запятая, минус)
  - Проверка диапазона (-5 до 5)
  - Мгновенная валидация при вводе
  - Отображение ошибок красным текстом
- **Валидация X и R**:
  - Выбор только из допустимых значений через Checkbox
  - Проверка на клиенте перед отправкой
- **Валидация на сервере**:
  - Минимальная проверка (R > 0)
  - Остальная валидация на клиенте

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 62-115, 126-166)
- `Web4/src/main/java/org/example/rest/ResultResource.java` (строки 61-66)

### ✅ Динамически обновляемая картинка области

**Требование**: Динамически обновляемая картинка, изображающая область на координатной плоскости в соответствии с номером варианта и точки, координаты которых были заданы пользователем.

**Реализация**:
- Компонент `Canvas` использует HTML5 Canvas API
- Отрисовка области (вариант 88744):
  - Квадрат в 4-й четверти
  - Треугольник во 2-й четверти
  - Четверть круга в 1-й четверти
- Отрисовка точек из результатов:
  - Зеленые точки - попадание
  - Красные точки - непопадание
- Автоматическая перерисовка при изменении `r` или `points`
- Используется `useEffect` для отслеживания изменений

**Файлы**:
- `Web4Frontend/src/components/Canvas.js`
- `Web4Frontend/src/components/MainPage.js` (строки 342-351)

### ✅ Клик по картинке для выбора точки

**Требование**: Клик по картинке должен инициировать сценарий, осуществляющий определение координат новой точки и отправку их на сервер для проверки её попадания в область.

**Реализация**:
- Обработчик `handleClick` в `Canvas.js`
- Преобразование координат клика в координаты графика
- Учет масштаба canvas (для адаптивности)
- Автоматическая отправка на сервер через `dispatch(checkPoint())`
- Точность координат: до 5 знаков после запятой

**Файлы**:
- `Web4Frontend/src/components/Canvas.js` (строки 151-167)
- `Web4Frontend/src/components/MainPage.js` (строки 168-210)

### ✅ Цвет точек зависит от попадания

**Требование**: Цвет точек должен зависить от факта попадания / непопадания в область.

**Реализация**:
- Зеленый цвет (`#28a745`) - попадание (`point.hit === true`)
- Красный цвет (`#dc3545`) - непопадание (`point.hit === false`)
- Отрисовка через `ctx.arc()` с соответствующим `fillStyle`

**Файлы**:
- `Web4Frontend/src/components/Canvas.js` (строки 130-147)

### ✅ Смена радиуса инициирует перерисовку

**Требование**: Смена радиуса также должна инициировать перерисовку картинки.

**Реализация**:
- `useEffect` в `Canvas.js` зависит от `r` и `points`
- При изменении `r` график перерисовывается автоматически
- Масштаб графика пересчитывается на основе нового R

**Файлы**:
- `Web4Frontend/src/components/Canvas.js` (строки 6, 149)

### ✅ Таблица со списком результатов

**Требование**: Таблицу со списком результатов предыдущих проверок.

**Реализация**:
- Таблица с колонками: X, Y, R, Результат, Время, Время выполнения (мкс)
- Данные загружаются через `fetchResults(userId)`
- Отображение результатов из Redux store
- Цвет результата: зеленый (Попадание) / красный (Непопадание)
- Адаптивный дизайн: таблица расширяется вниз, а не в ширину

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 346-400)
- `Web4Frontend/src/styles.css` (строки 93-154)

### ✅ Ссылка для выхода

**Требование**: Ссылку, по которой аутентифицированный пользователь может закрыть свою сессию и вернуться на стартовую страницу приложения.

**Реализация**:
- Кнопка "Выйти из системы" в левом верхнем углу header
- При клике вызывается `handleLogout()`
- Очищается `localStorage` и Redux store
- Автоматический переход на `LoginPage`

**Файлы**:
- `Web4Frontend/src/components/MainPage.js` (строки 230, 251-261)

## Дополнительные требования

### ✅ Сохранение результатов в Apache Derby

**Требование**: Все результаты проверки должны сохраняться в базе данных под управлением СУБД Apache Derby.

**Реализация**:
- Используется **Apache Derby Embedded** (in-memory)
- Таблица `results` в БД:
  - `ID` (BIGINT, автоинкремент)
  - `X, Y, R` (DECIMAL(31,15))
  - `HIT` (BOOLEAN)
  - `TIMESTAMP` (TIMESTAMP)
  - `EXECUTIONTIME` (BIGINT)
  - `user_id` (BIGINT, FK)
- Сохранение через `ResultEJB.checkPoint()` → `em.persist(result)`

**Файлы**:
- `Web4/src/main/resources/META-INF/persistence.xml`
- `Web4/src/main/java/org/example/ejb/PersistenceInitializer.java` (строки 36-49)
- `Web4/src/main/java/org/example/ejb/ResultEJB.java` (строки 26-55)

### ✅ Использование JPA для доступа к БД

**Требование**: Для доступа к БД необходимо использовать JPA.

**Реализация**:
- Используется **JPA** через **EclipseLink**
- **EntityManager** для всех операций с БД
- **NamedQueries** для оптимизации запросов
- **@Entity**, `@Table`, `@Column` аннотации
- **@ManyToOne** для связи Result-User
- **RESOURCE_LOCAL** транзакции с явным управлением

**Файлы**:
- `Web4/src/main/resources/META-INF/persistence.xml`
- `Web4/src/main/java/org/example/entity/User.java`
- `Web4/src/main/java/org/example/entity/Result.java`
- `Web4/src/main/java/org/example/ejb/UserEJB.java`
- `Web4/src/main/java/org/example/ejb/ResultEJB.java`

## Итоговая таблица соответствия

| Требование | Статус | Реализация |
|------------|--------|------------|
| Backend на Java EE с EJB | ✅ | UserEJB, ResultEJB, PersistenceInitializer |
| Frontend на React + Redux | ✅ | React 18, Redux, ES6, JSX |
| Компоненты Belle | ✅ | Кастомная реализация BelleComponents |
| REST API | ✅ | JAX-RS, AuthResource, ResultResource |
| 2 страницы | ✅ | LoginPage, MainPage |
| Адаптивный дизайн (3 режима) | ✅ | CSS Media Queries |
| Шапка с ФИО/группой/вариантом | ✅ | "Павлов Эдгар P3216 88744" |
| Форма логина/пароля | ✅ | TextInput компоненты |
| Хранение в БД с хэшированием | ✅ | BCrypt, таблица users |
| Запрет доступа неавторизованных | ✅ | Проверка isAuthenticated |
| Checkbox для X | ✅ | xValues массив |
| TextInput для Y | ✅ | Валидация формата и диапазона |
| Checkbox для R | ✅ | rValues массив |
| Валидация некорректных данных | ✅ | Клиентская валидация Y |
| Динамическая картинка области | ✅ | Canvas компонент |
| Клик по картинке | ✅ | handleClick → checkPoint |
| Цвет точек | ✅ | Зеленый/красный по hit |
| Перерисовка при смене R | ✅ | useEffect зависимость от r |
| Таблица результатов | ✅ | results-table |
| Ссылка для выхода | ✅ | Кнопка в header |
| Apache Derby | ✅ | jdbc:derby:memory:web4db |
| JPA для доступа к БД | ✅ | EclipseLink, EntityManager |

## Заключение

Все требования технического задания выполнены. Приложение использует:
- Java EE (EJB) для backend
- React + Redux для frontend
- REST API для взаимодействия
- Apache Derby для хранения данных
- JPA для доступа к БД
- Адаптивный дизайн для 3 режимов отображения


